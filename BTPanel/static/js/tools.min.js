var bt_tools={table:function(e){function t(e){this.config=e,this.$load()}return t.prototype={style_list:[],event_list:{},checkbox_list:[],batch_active:{},event_rows_model:{},data:[],page:"",column:[],batch_thread:[],random:bt.get_random(5),init:!1,checked:!1,$load:function(){var e=this;this.config.init&&this.config.init(this),$(this.config.el).addClass("bt_table"),this.config.minWidth&&this.style_list.push({className:this.config.el+" table",css:"min-width:"+this.config.minWidth}),this.config.tootls?this.$reader_tootls(this.config.tootls):0===$(e.config.el+".divtable").length&&$(e.config.el).append('<div class="divtable mtb10"></div>'),this.$reader_content(),void 0!==e.config.url?this.$refresh_table_list():void 0!==this.config.data?this.$reader_content(this.config.data):alert("缺少data或url参数"),this.config.methods&&$.extend(this,this.config.methods)},$refresh_table_list:function(e){var t,s=this;e&&(t=bt.load("正在获取列表数据,请稍候...")),this.$http(function(a,i){e&&t.close(),s.$reader_content(a,i)})},$reader_content:function(e,t){var s=this,a="",i="",n=0,c=this.config.column,l={},o=$(s.config.el+" .checkbox_"+s.random);e=e||[],this.data=e,o.length&&(o.removeClass("active selected"),s.checkbox_list=[],s.$set_batch_view());do{var r=e[n],d=0;e.length>0&&(i+="<tr>");for(var h=0;h<c.length;h++){var p=c[h];if($.isEmptyObject(p))d++;else{if(0===n&&!this.init){this.init||this.style_list.push(this.$dynamic_merge_style(p,h-d));var u="sort_"+this.random,f="checkbox_"+this.random,b=p.sortValue||"desc";a+="<th><span "+(p.sort?'class="not-select '+u+(p.sortValue?" sort-active":"")+' cursor-pointer"':"")+' data-index="'+h+'" '+(p.sort?'data-sort="'+b+'"':"")+">"+("checkbox"==p.type?'<label><i class="cust—checkbox cursor-pointer '+f+'" data-checkbox="all"></i><input type="checkbox" class="cust—checkbox-input"></label>':"<span>"+p.title+"</span>")+(p.sort?'<span class="glyphicon glyphicon-triangle-'+("desc"==b?"bottom":"top")+' ml5"></span>':"")+"</span></th>",0===n&&(!l[u]&&p.sort&&(l[u]={event:this.config.sortEvent,eventType:"click",type:"sort"}),l[f]||(l[f]={event:p.checked,eventType:"click",type:"checkbox"}))}if(void 0!==r){var v="",_="event-"+p.fid+"-"+this.random;p.template?v=s.$custom_template_render(p,r,h):(v=this.$reader_column_type(p,r),l=$.extend(l,v[1]),v=v[0]),i+="<td><span "+(p.class?'class="'+p.class+'"':"")+" "+(p.tips?'title="'+p.tips+'"':"")+">"+v+"</span></td>",0===n&&!l[_]&&p.event&&(l[_]={event:p.event,eventType:"click",type:"rows"})}}}e.length>0&&(i+="</tr>"),0==e.length&&(i+='<tr><td colspan="'+(c.length-d)+'" style="text-align:center;">'+(this.config.default||"数据为空")+"</td></tr>"),n++}while(n<e.length);this.init||this.$style_bind(this.style_list),this.$event_bind(l),this.init?($(this.config.el+" .divtable tbody").html(i),this.config.page&&t&&$(this.config.el+" .page").replaceWith(this.$reader_page(this.config.page,t))):$(this.config.el+" .divtable").append('<table class="table table-hover"><thead>'+a+"</thead><tbody>"+i+"</tbody></table></div></div>"),this.init=!0,this.config.success&&this.config.success(this)},$custom_template_render:function(e,t,s){var a="event-"+e.fid+"-"+this.random,i=e.template(t,s),n=$(i);return n.length>0?template=n.addClass(a)[0].outerHTML:"text"===e.type?template='<span class="'+a+'">'+i+"</span>":template='<a href="javascript:;" class="btlink '+a+'">'+i+"</a>",template},$modify_row_data:function(e){this.event_rows_model.rows=$.extend(this.event_rows_model.rows,e);var t=this.event_rows_model,s=null;s=void 0!==t.model.template?$(this.$custom_template_render(t.model,t.rows,t.index)):$(this.$reader_column_type(t.model,t.rows)[0]),t.el.replaceWith(s),t.el=s},$batch_success_table:function(e){var t=this;bt.open({type:1,title:e.title,area:e.area||["350px","350px"],shadeClose:!1,closeBtn:2,content:e.content||'<div class="batch_title"><span class><span class="batch_icon"></span><span class="batch_text">'+e.title+'操作完成！</span></span></div><div class="fiexd_thead divtable" style="margin: 15px 30px 15px 30px;overflow: auto;height: 200px;"><table class="table table-hover"><thead><tr><th>'+e.th+'</th><th style="text-align:right;width:120px;">操作结果</th></tr></thead><tbody>'+e.html+"</tbody></table></div>",success:function(){t.$fixed_table_thead(".fiexd_thead")}})},$delete_table_row:function(e){this.data.splice(e,1),this.$reader_content(this.data)},$fixed_table_thead:function(e){$(e).scroll(function(){var e=this.scrollTop;this.querySelector("thead").style.transform="translateY("+e+"px)"})},$set_batch_view:function(){if(void 0!==this.config.batch){var e=$(this.config.el+" .set_batch_option");if(void 0!==this.config.batch.config)this.checkbox_list.length>0?e.removeClass("bt-disabled btn-default").addClass("btn-success").text("批量"+this.batch_active.title+"(已选中"+this.checkbox_list.length+")"):e.addClass("bt-disabled btn-default").removeClass("btn-success").text("批量"+this.batch_active.title);else{var t=$(this.config.el+" .bt_select_value");this.checkbox_list.length>0?(e.removeClass("bt-disabled btn-default").addClass("btn-success").prev().removeClass("bt-disabled"),t.find("em").html("(已选中"+this.checkbox_list.length+")")):(e.addClass("bt-disabled btn-default").removeClass("btn-success").prev().addClass("bt-disabled"),t.children().eq(0).html("请选择批量操作<em></em>"),t.next().find("li").removeClass("active"),this.batch_active={})}}return!1},$reader_column_type:function(e,t){var s=t[e.fid],a={},i="",n=[],c=this;switch(e.type){case"text":n=[s,a];break;case"checkbox":n=['<label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'"></i><input type="checkbox" class="cust—checkbox-input"></label>',a];break;case"password":i="ico_"+c.random+"_";var l='<span class="bt-table-password mr10"><i>**********</i></span>';e.eye_open&&(l+='<span class="glyphicon cursor pw-ico glyphicon-eye-open mr10 '+i+'eye_open" title="显示密码"></span>',a[i+"eye_open"]||(a[i+"eye_open"]={type:"eye_open_password"})),e.copy&&(l+='<span class="ico-copy cursor btcopy mr10 '+i+'copy" title="复制密码"></span>',a[i+"copy"]||(a[i+"copy"]={type:"copy_password"})),n=[l,a];break;case"link":i="click_"+e.fid+"_"+this.random,!a[i]&&e.event&&(a[i]={event:e.event,type:"rows"}),n=['<a class="btlink '+i+'" href="'+(e.href?s:"javascript:;")+'" '+(e.href?'target="'+(e.target||"_blank")+'"':"")+' title="'+s+'">'+s+"</a>",a];break;case"input":blurName="blur_"+e.fid+"_"+this.random,keyupName="keyup_"+e.fid+"_"+this.random,!a[blurName]&&e.blur&&(a[blurName]={event:e.blur,eventType:"blur",type:"rows"}),!a[keyupName]&&e.keyup&&(a[keyupName]={event:e.keyup,eventType:"keyup",type:"rows"}),n=['<input type="text" title="点击编辑内容，按回车或失去焦点自动保存"  class="table-input '+blurName+" "+keyupName+'" value="'+s+'">',a];break;case"status":var o="";i="click_"+e.fid+"_"+this.random,$.each(e.config.list,function(e,t){t[0]===s&&(o=t)}),!a[i]&&e.event&&(a[i]={event:e.event,type:"rows"}),n=['<a class="btlink '+i+" "+(o[2].indexOf("#")>-1?"":o[2])+'" style="'+(o[2].indexOf("#")>-1?"color:"+o[2]+";":"")+'" href="javascript:;"><span>'+o[1]+"</span>"+(e.config.icon?'<span class="glyphicon '+o[3]+'"></span>':"")+"</a>",a];break;case"switch":break;case"group":var r="";$.each(e.group,function(s,n){if(i=(e.fid?e.fid:"group")+"_"+s+"_"+c.random,n.template){var l=n.template(t,c),o=$(l);o.length>0?r+=o.addClass(i)[0].outerHTML:r+='<a href="javascript:;" class="btlink '+i+'">'+l+"</a>"}else r+='<a href="javascript:;" class="btlink '+i+'" '+(n.hide?'style="display:none;"':"")+">"+n.title+"</a>";r+=e.group.length-1!=s?"&nbsp;&nbsp;|&nbsp;&nbsp;":"",!a[i]&&n.event&&(a[i]={event:n.event,type:"rows"})}),n=[r,a];break;default:n=[s,a]}return n},$reader_tootls:function(e){function t(e,t){var s=bt.load("正在执行批量"+e.title+"，请稍候..."),i={},n=a.$get_data_batch_list(e.paramId,t);e.beforeRequest?i[e.paramName]=e.beforeRequest(t):i[e.paramName]=n.join(","),bt_tools.send({url:e.url||a.config.batch.url,data:$.extend(e.param||{},i)},function(i){if(s.close(),!i.status)return!1;if(void 0===e.tips||e.tips){var n="";$.each(i.error,function(e,t){n+="<tr><td><span>"+e+'</span/></td><td><div style="float:right;" class="size_ellipsis"><span style="color:red">'+t+"</span></div></td></tr>"}),$.each(i.success,function(e,t){n+="<tr><td><span>"+t+'</span></td><td><div style="float:right;" class="size_ellipsis"><span style="color:#20a53a">操作成功</span></div></td></tr>'}),a.$batch_success_table({title:"批量"+e.title,th:e.theadName,html:n}),a.$refresh_table_list(!0)}e.success&&e.success(i,t,a)})}function s(e,s,a){e.callback?e.callback({loadT:0,config:{},check_list:s,start_batch:function(t,s){e.load&&(this.loadT=layer.msg("正在执行批量"+e.title+'，<span class="batch_progress">进度:0/'+this.check_list.length+"</span>,请稍候...",{icon:16,skin:"batch_tips",shade:.3,time:0})),this.config={param:t,url:e.url},this.bacth(s)},bacth:function(t,i){var n=this,c={};"function"==typeof t&&(i=t,t=0),t<this.check_list.length?(c="function"==typeof e.param?e.param(s[t]):e.param,this.config.param=$.extend(this.config.param,c),e.paramId&&(n.config.param[e.paramId]=n.check_list[t][e.paramId]),this.config.param.bacth&&t==this.check_list.length-1&&delete this.config.param.bacth,bt_tools.send({url:this.config.url,data:this.config.param,bacth:!0},function(e){$.extend(n.check_list[t],{request:{status:"boolean"==typeof e.status&&e.status,msg:e.msg||"请求网络错误"}}),t++,n.bacth(t,i)})):(a&&a(),i(this.check_list),layer.close(this.loadT))}}):e.confirm?t(e,s):e.confirmVerify?bt.show_confirm("批量"+e.title,"批量"+e.title+"，该操作可能会存在风险，是否继续？",t):bt.confirm({title:"批量"+e.title,msg:"批量"+e.title+"，该操作可能会存在风险，是否继续？"},function(){t&&t(e,s)})}for(var a=this,i={},n=0;n<e.length;n++){var c="",l=e[n];switch(l.type){case"group":$.each(l.list,function(e,t){var s=l.type+"_"+a.random+"_"+e;t.group?(c+='<div class="btn-group" style="vertical-align: top;">\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default '+s+' btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span style="margin-right:2px;">分类管理</span><span class="caret" style="position: relative;top: -1px;"></span></button>\t\t\t\t\t\t\t\t\t\t<ul class="dropdown-menu"></ul>\t\t\t\t\t\t\t\t\t</div>',l.list&&$.each(l.list,function(e,t){'<li><a href="javascript:;" NaN'+t[l.key]+"</a></li>"}),t.init&&setTimeout(function(){t.init(s)},400)):c+='<button type="button" class="btn '+(t.active?"btn-success":"btn-default")+" "+s+' btn-sm mr5">'+t.title+"</button>",i[s]||(i[s]={event:t.event,type:"button"})});break;case"search":this.config.search=l;var o="search_input_"+this.random,r="search_focus_"+this.random,d="search_btn_"+this.random;c='<div class="bt_search"><input type="text" class="search_input '+o+'" style="'+(l.width?"width:"+l.width:"")+'" placeholder="'+(l.placeholder||"")+'"/><span class="glyphicon glyphicon-search '+d+'" aria-hidden="true"></span></div>',i[o]||(i[o]={eventType:"keyup",type:"search_input"}),i[r]||(i[r]={type:"search_focus",eventType:"focus"}),i[d]||(i[d]={type:"search_btn"});break;case"batch":this.config.batch=l;var h=[],p="",u=l.config;void 0!==l.config?(a.batch_active=u,$(a.config.el).on("click",".set_batch_option",function(e){for(var i=[],n=0;n<a.checkbox_list.length;n++)i.push(a.data[a.checkbox_list[n]]);if($(this).hasClass("bt-disabled"))return layer.tips(a.config.batch.disabledTips||"请选择需要批量操作的数据",$(this),{tips:[1,"red"],time:2e3}),!1;switch(typeof u.confirm){case"function":u.confirm(u,function(e,t){u.param=$.extend(u.param,e),s(u,i,t)});break;case"undefined":s(u,i);break;case"object":var c=u.confirm;bt.open({title:c.title||"批量操作",area:c.area||"350px",btn:c.btn||["确认","取消"],content:c.content,success:function(e,t){c.success(e,t,u)},yes:function(e,s){c.yes(e,s,function(e,s){u.param=$.extend(u.param,e),t(u,i)})}})}})):($.each(l.selectList,function(e,t){t.group?($.each(t.group,function(e,s){h.push($.extend({},t,s)),p+='<li class="item">'+s.title+"</li>"}),delete t.group):(h.push(t),p+='<li class="item">'+t.title+"</li>")}),$(a.config.el).on("click",".bt_table_select_group .bt_select_value",function(e){var t=$(this).parent(),s=t.find(".bt_selects"),i=t.offset(),n=a.$get_win_area();return t.hasClass("bt-disabled")?(layer.tips(a.config.batch.disabledSelectValue,t,{tips:[1,"red"],time:2e3}),!1):(t.hasClass("active")?t.removeClass("active"):t.addClass("active"),s.height()>n[1]-i.top?s.addClass("top"):s.removeClass("top"),$(document).one("click",function(){return $(a.config.el).find(".bt_table_select_group").removeClass("active"),!1}),!1)}),$(a.config.el).on("click",".bt_table_select_group .item",function(e){var t=$(this).text(),s=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$(a.config.el+" .bt_select_tips").html("批量"+t+"<em>(已选中"+a.checkbox_list.length+")</em>"),a.batch_active=h[s],a.checked||$(".bt_table_select_group").removeClass("active")}),$(a.config.el).on("click",".set_batch_option",function(e){var i=[],n=a.batch_active;if($(this).hasClass("bt-disabled"))return layer.tips(a.config.batch.disabledSelectValue,$(this),{tips:[1,"red"],time:2e3}),!1;for(var c=0;c<a.checkbox_list.length;c++)i.push(a.data[a.checkbox_list[c]]);if("{}"===JSON.stringify(n)){var l=$(a.config.el+" .bt_table_select_group");return layer.tips("请选择需要批量操作的类型",l,{tips:[1,"red"],time:2e3}),l.css("border","1px solid red"),setTimeout(function(){l.removeAttr("style")},2e3),!1}switch(typeof n.confirm){case"function":n.confirm(n,function(e,t){n.param=$.extend(n.param,e),s(n,i,t)});break;case"undefined":s(n,i);break;case"object":var o=n.confirm;bt.open({title:o.title||"批量操作",area:o.area||"350px",btn:o.btn||["确认","取消"],content:o.content,success:function(e,t){o.success(e,t,n)},yes:function(e,s){o.yes(e,s,function(e,s){n.param=$.extend(n.param,e),t(n,i)})}})}})),c='<div class="bt_batch"><label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'" data-checkbox="all"></i><input type="checkbox" lass="cust—checkbox-input" /></label>'+(void 0!==l.config?'<button class="btn btn-default btn-sm set_batch_option bt-disabled">批量'+l.config.title+"</button>":'<div class="bt_table_select_group bt-disabled not-select"><span class="bt_select_value"><span class="bt_select_tips">请选择批量操作<em></em></span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_selects ">'+p+'</ul></div><button class="btn btn-default btn-sm set_batch_option bt-disabled" >'+l.buttonValue+"</button>")+"</div>";break;case"page":this.config.page=l;var f=bt.get_cookie(this.config.cookiePrefix+"_"+this.config.page.numberParam);this.config.cookiePrefix&&f&&(this.config.page.number=f),c=this.$reader_page(this.config.page,'<div><span class="Pcurrent">1</span><span class="Pcount">共0条数据</span></div>')}if(c){var b=$(a.config.el+" .tootls_"+l.positon[1]);if(b.length){var v=b.find(".pull-"+l.positon[0]);v.append(c)}else{var _='<div class="tootls_group tootls_'+l.positon[1]+'"><div class="pull-left">'+("left"==l.positon[0]?c:"")+'</div><div class="pull-right">'+("right"==l.positon[0]?c:"")+"</div></div>";"top"===l.positon[1]?($(a.config.el).append(_),0===$(a.config.el+" .divtable").length&&$(a.config.el).append('<div class="divtable mtb10"></div>')):(0===$(a.config.el+" .divtable").length&&$(a.config.el).append('<div class="divtable mtb10"></div>'),$(a.config.el).append(_))}}}this.init||this.$event_bind(i)},$get_data_batch_list:function(e,t){var s=[];return $.each(t||this.data,function(t,a){s.push(a[e])}),s},$reader_page:function(e,t){var s=this,a=$(t),i="",n={};if(a.find("a").addClass("page_link_"+this.random),i+=a.html(),e.numberStatus){var c="page_select_"+this.random;i+='<select class="page_select_number '+c+'">',$.each(e.numberList,function(t,s){i+='<option value="'+s+'" '+(e.number==s?"selected":"")+">"+s+"条/页</option>"}),i+="</select>",n[c]={eventType:"change",type:"page_select"}}if(e.jump){var l="page_jump_input-"+this.random,o="page_jump_btn_"+this.random;i+='<div class="page_jump_group"><span class="page_jump_title">跳转到</span><input type="number" class="page_jump_input '+l+'" value="'+e.page+'" /><span class="page_jump_title">页</span><button type="button" class="page_jump_btn '+o+'">确认</button></div>',n[l]={eventType:"keyup",type:"page_jump_input"},n[o]={type:"page_jump_btn"}}return n["page_link_"+this.random]={type:"cut_page_number"},s.config.page.total=parseInt(a.find(".Pcount").html().match(/([0-9]*)/g)[1]),s.$event_bind(n),'<div class="page">'+i+"</div>"},$dynamic_merge_style:function(e,t){var s="";return $.each(e,function(e,t){switch(e){case"align":s+="text-align:"+t+";";break;case"width":s+="width:"+("string"==typeof t?t:t+"px")+";";break;case"style":s+=t;break;case"minWidth":s+="min-width:"+("string"==typeof t?t:t+"px")+";";break;case"maxWidth":s+="max-width:"+("string"==typeof t?t:t+"px")+";"}}),{index:t,css:s}},$event_bind:function(e){var t=this;$.each(e,function(e,s){if(t.event_list[e]&&t.event_list[e].eventType===s.eventType)return!0;t.event_list[e]=s,$(t.config.el).on(s.eventType||"click","."+e,function(a){var i=$(this).parents("tr").index(),n=$(this).data(),c=[];switch(s.type){case"rows":t.event_rows_model={el:$(this),model:t.config.column[$(this).parents("td").index()],rows:t.data[i],index:i},c=[t.event_rows_model.rows,t.event_rows_model.index,a,e,t];break;case"sort":var l=t.config.column[n.index];$(this).hasClass("sort-active")&&$(".sort_"+t.random+" .sort-active").data({sort:"desc"}),$(".sort_"+t.random).removeClass("sort-active").find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom"),$(this).addClass("sort-active"),"asc"==n.sort?($(this).data({sort:"desc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom")):($(this).data({sort:"asc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-bottom").addClass("glyphicon-triangle-top")),t.config.sort=t.config.sortParam({name:l.fid,sort:n.sort}),t.$refresh_table_list(!0);break;case"checkbox":var o=$(t.config.el+' [data-checkbox="all"]'),r=$(t.config.el+" tbody .checkbox_"+t.random);null==n.checkbox?$(this).hasClass("active")?($(this).removeClass("active"),t.checkbox_list.splice(t.checkbox_list.indexOf(i),1),t.checkbox_list.length>0?o.addClass("selected").removeClass("active"):o.removeClass("selected active")):($(this).addClass("active"),t.checkbox_list.push(i),t.data.length===t.checkbox_list.length?o.addClass("active").removeClass("selected"):t.checkbox_list.length>0&&o.addClass("selected")):t.checkbox_list.length===t.data.length?(t.checkbox_list=[],r.removeClass("active selected").next().prop("checked","checked"),o.removeClass("active")):(r.each(function(e,s){$(this).hasClass("active")||($(this).addClass("active").next().prop("checked","checked"),t.checkbox_list.push(e))}),o.removeClass("selected").addClass("active")),t.$set_batch_view();break;case"button":c.push(a,t);break;case"search_focus":var d=$(t.config.el+" .bt_search_tips");$(t.config.el+" .bt_search_tips").length>0&&d.remove();break;case"search_input":if(13==a.keyCode)return $(t.config.el+" .search_btn_"+t.random).click(),!1;break;case"search_btn":var h=$(t.config.el+" .search_input"),p=$(t.config.el+" .search_input").val();t.config.search.value=p,h.append('<div class="bt_search_tips"><span>'+p+'</span><i class="bt_search_close"></i></div>'),t.$refresh_table_list(!0);break;case"page_select":var u=parseInt($(this).val());return t.config.page.number=u,t.config.page.page=1,t.$refresh_table_list(!0),!1;case"page_jump_input":return 13==a.keyCode&&($(t.config.el+" .page_jump_btn_"+t.random).click(),$(this).focus()),!1;case"page_jump_btn":var f=parseInt($(t.config.el+" .page_jump_input-"+t.random).val()),b=Math.ceil(t.config.page.total/t.config.page.number);f>b&&(f=t.config.page.page),t.config.page.page=f,t.$refresh_table_list(!0);break;case"cut_page_number":var v=parseInt($(this).attr("href").match(/([0-9]*)$/)[0]);return t.config.page.page=v,t.$refresh_table_list(!0),!1;case"eye_open_password":return $(this).hasClass("glyphicon-eye-open")?($(this).addClass("glyphicon-eye-close").removeClass("glyphicon-eye-open"),$(this).prev().text(t.data[i].password)):($(this).addClass("glyphicon-eye-open").removeClass("glyphicon-eye-close"),$(this).prev().html("<i>**********</i>")),!1;case"copy_password":return bt.pub.copy_pass(t.data[i].password),!1}s.event&&s.event.apply(this,c)})})},$style_bind:function(e,t){var s="",a=this;$.each(e,function(e,t){""!=t.css&&(t.className?s+=t.className+"{"+t.css+"}":s+=a.config.el+" thead th:nth-child("+(t.index+1)+"),"+a.config.el+" tbody tr td:nth-child"+(t.span?" span":"")+"("+(t.index+1)+"){"+t.css+"}")}),0==$("#bt_table_"+a.random).length&&$(a.config.el).append('<style type="text/css" id="bt_table_'+a.random+'">'+s+"</style>")},$get_win_area:function(){return[window.innerWidth,window.innerHeight]},$http:function(e){var t={},s=this.config,a=s.page,i=s.search,n=s.sort||{};a&&(t[a.numberParam]=a.number,t[a.pageParam]=a.page,this.config.cookiePrefix&&bt.set_cookie(this.config.cookiePrefix+"_"+a.numberParam,a.number)),i&&(t[i.searchParam]=i.value),this.config.beforeRequest&&(s.param=this.config.beforeRequest(s.param)),bt_tools.send({url:s.url,data:$.extend(s.param,t,n)},function(t){if(s.dataFilter){var a=s.dataFilter(t);e&&e(a.data,a.page)}else e&&e(t.data,t.page)})}},new t(e)},form:function(e){function t(e){this.config=e,this.$load()}var s=this;return t.prototype={element:null,style_list:[],event_list:{},event_type:["click","event","focus","keyup","blur","change"],hide_list:[],form_element:{},form_config:{},random:bt.get_random(5),$load:function(){var e=this;e.el&&this.$reader_content(function(){e.$event_bind()})},$reader_content:function(e){var t=this,a="",i="",n={};return $.each(t.config.form,function(e,s){a+=t.$reader_content_row(e,s)}),t.element=$('<form class="bt-form" data-form="'+t.random+'">'+a+"</form>"),i=$('<div class="'+s.$verify(t.config.class)+'"><input type="checkbox" class="blur_checked input_checked_'+t.random+'"></div>'),i.append(t.element),n["input_checked_"+t.random]={focus:{type:"input_checked",onEvent:!1,event:function(e,t){return t.checked=!0,!1}},blur:{type:"input_checked",onEvent:!1,event:function(e,t){t.checked=!1,t.checked_blur&&t.checked_blur(e)}}},$.extend(t.event_list,n),e&&e(),i[0].outerHTML},$reader_content_row:function(e,t){var a=this,i=t.help;return'<div class="line'+s.$verify(t.class)+s.$verify(t.hide,"hide",!0)+'"'+s.$verify(t.id,"id")+">"+(t.label?'<span class="tname">'+t.label+"</span>":"")+'<div class="'+(t.label?"info-r":"")+s.$verify(t.line_class)+'"'+s.$verify(a.$reader_style(t.line_style),"style")+">"+a.$reader_form_element(t.group,e)+(i?'<div class="c9 mt5 '+s.$verify(i.class,"class")+'" '+s.$verify(a.$reader_style(i.style),"style")+">"+i.list.join("</br>")+"</div>":"")+"</div></div>"},$reader_form_element:function(e,t){var a=this,i="",n={};return Array.isArray(e)||(e=[e]),$.each(e,function(e,c){var l=a.$reader_style(c.style)+s.$verify(c.width,"width","style"),o=a.$verify_group(c,["name","value","placeholder","disabled","readonly","autofocus","autocomplete","min","max"]),r=a.$create_event_config(c),d="";switch(i+=c.label?'<span class="mr5">'+c.label+"</span>":"",void 0!==c.name&&(n[c.name]=r),c.type){case"text":case"checkbox":case"password":case"radio":case"number":var h="event_"+c.name+"_"+a.random;i+='<input type="'+c.type+'"'+o+" "+(c.icon?'id="'+h+'"':"")+' class="bt-input-'+("select_path"!=c.type?c.type:"text")+" mr10 "+(c.label?"form_middle":"")+s.$verify(c.class,"class")+'"'+s.$verify(l,"style")+" />",c.icon&&(i+='<span class="glyphicon '+c.icon.type+" "+c.name+'_icon cursor" '+s.$verify(a.$reader_style(c.icon.style),"style")+"></span>",n[c.name+"_icon"]={click:{type:"select_path",config:c}});break;case"textarea":if(i+='<textarea class="bt-input-text"'+s.$verify(l,"style")+o+" >"+(c.value||"")+"</textarea>",$.each(["blur","focus","input"],function(e,t){if(c.tips){var s=null;switch(t){case"blur":s=function(e,t){""===$(this).val()&&$(this).next().show(),layer.close(t.tips.loadT)};break;case"focus":s=function(e,t){$(this).next().hide(),t.tips.loadT=layer.tips(p,$(this),{tips:[1,"#20a53a"],time:0,area:$(this).width()})}}}n[c.name][t]?n[c.name][t].added=s:n[c.name][t]={type:c.type,cust:!1,event:c[t],added:s}}),c.tips){var p="";p=void 0===c.tips.list?c.tips.text:c.tips.list.join("</br>"),i+='<div class="placeholder c9 '+c.name+'_tips" '+s.$verify(a.$reader_style(c.tips.style),"style")+">"+p+"</div>",n[c.name+"_tips"]={click:{type:"textarea_tips",config:c}}}break;case"select":i+=a.$reader_select(c,l,o,t),a.event_list.custom_select={click:{type:"custom_select",children:".bt_select_value"}},a.event_list.custom_select_item={click:{type:"custom_select_item",children:"li.item"}};break;case"link":d="event_"+bt.get_random(6),i+='<a href="'+(c.href||"javascript:;")+'" class="btlink offsetY7'+s.$verify(c.class,"class")+" "+d+'" '+s.$verify(a.$reader_style(c.style),"style")+">"+c.title+"</a>",a.event_list[d]={click:{type:"link_event",event:c.event}};break;case"help":var u="";$.each(c.list,function(e,t){u+="<li>"+t+"</li>"}),i+='<ul class="help-info-text c7'+s.$verify(c.class)+'"'+s.$verify(a.$reader_style(c.style),"style")+">"+u+"</ul>"}a.form_config[c.name]=c}),$.extend(a.event_list,n),i},$create_event_config:function(e){var t={};return void 0===e.name?{}:($.each(this.event_type,function(s,a){e[a]&&(t["event"===a?"click":a]={type:e.type,event:e[a],cust:["select","checkbox","radio"].indexOf(e.type)>-1,config:e})}),t)},$reader_style:function(e){var t="";return"string"==typeof e?e:void 0===e?"":($.each(e,function(e,s){t+=e+":"+s+";"}),t)},$reader_select:function(e,t,a,i){var n=this,c="",l="",o={};if(!Array.isArray(e.list)){var r=e.list;bt_tools.send({url:r.url,data:r.param||{}},function(t){!1!==t.status?(e.list=e.list.dataFilter?e.list.dataFilter(t):t,n.$replace_render_content(i)):bt.msg(t)})}return $.each(e.list,function(t,a){o=a.value===e.value||a.value===n.config.data[e.name]?a:e.list[0],c+='<li class="item'+s.$verify(a.value===o.value?"active":"")+" "+(a.disabled?"disabled":"")+'">'+a.title+"</li>",l+='<option value="'+a.value+'"'+(a.disabled?"disabled":"")+" "+s.$verify(a.value===o.value?"selectd":"")+">"+a.title+"</option>"}),!o.title&&Array.isArray(e.list)&&(o=e.list[0]),'<div class="bt_select_updown mr10 '+(e.disabled?"bt-disabled":"")+" "+s.$verify(e.hide,"hide",!0)+s.$verify(e.class)+'" '+s.$verify(t,"style")+' data-name="'+e.name+'"><span class="bt_select_value"><span class="bt_select_content">'+(o.title||"获取数据中...")+'</span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_select_list">'+(c||"")+"</ul><select"+a+' class="hide" '+(e.disabled?"disabled":"")+">"+(l||"")+"</select></div>"},$replace_render_content:function(e){var t=this,s=this.config.form[e];$("[data-form="+t.random+"]").find(".line:eq("+e+")").replaceWith(t.$reader_content_row(e,s))},$event_bind:function(e,t){var s=this,a={};s.element=$("object"==typeof e?s.element:"[data-form="+s.random+"]"),void 0===e&&(a=s.event_list),$.each(a,function(e,t){if($.isEmptyObject(t))return!0;$.each(t,function(t,a){var i="";i="boolean"==typeof a.cust?"["+(a.cust?"data-":"")+"name="+e+"]":"."+e,function(e,a){if(!1===e.onEvent){switch(e.type){case"input_checked":$(i).on("event"!=t?t:"click",function(t){e.event.apply(this,[t,s])})}return!0}s.element.on("event"!=t?t:"click",e.children?e.children:i,function(t){var i=s.$get_form_element(),n=s.$get_form_value(),c=s.form_config[a];switch(e.type){case"textarea_tips":$(this).hide().prev().focus();break;case"custom_select":if($(this).parent().hasClass("bt-disabled"))return!1;var l=$(this).next();return l.hasClass("show")?l.removeClass("show"):($(".bt_select_list").removeClass("show"),l.addClass("show")),$(document).click(function(){return s.element.find(".bt_select_list").removeClass("show"),$(this).unbind("click"),!1}),!1;case"custom_select_item":if(c=s.form_config[$(this).parents(".bt_select_updown").attr("data-name")],item_config=c.list[$(this).index()],$(this).hasClass("disabled"))return $(this).parent().removeClass("show"),item_config.tips&&layer.msg(item_config.tips,{icon:2}),!0;$(this).hasClass("active")||$(this).hasClass("disabled")||($(this).parent().prev().find(".bt_select_content").text($(this).text()),$(this).addClass("active").siblings().removeClass("active"),$(this).parent().next().val(item_config.value.toString()),$(this).parent().removeClass("show"),$(this).parent().next().trigger("change"));break;case"select_path":bt.select_path("event_"+$(this).prev().attr("name")+"_"+s.random)}e.event&&e.event.apply(this,[n,i,s,c,t]),e.added&&e.added.apply(this,[t,c])})}(a,e)})}),t&&t()},$get_form_value:function(){return this.element.serializeObject()},$set_find_value:function(e,t){var s={},a=this;"string"!=typeof e?s=e:s[e]=t,$.each(s,function(e,t){a.form_element[e].val(t)})},$get_form_element:function(e){var t={},s=this;if(!e&&!$.isEmptyObject(s.form_element))return s.form_element;this.element.find(":input").each(function(e){t[$(this).attr("name")]=$(this)}),s.form_element=t},$verify_group:function(e,t){var s="";return $.each(t,function(t,a){if(void 0===e[a])return!0;["disabled","readonly"].indexOf(a)>-1?s+=" "+(e[a]?a+'="'+a+'"':""):s+=" "+a+'="'+e[a]+'"'}),s},$verify_bind_event:function(e,t,s){var a={};return $.each(s,function(s,i){var n=t[i];n&&("object"==typeof a[e]?(Array.isArray(a[e])||(a[e]=[a[e]]),a[e].push({event:n,eventType:i})):a[e]={event:n,eventType:i})}),a},$verify:function(e,t,s){return e?!0===s?e?" "+t:"":"style"===s?t?t+":"+e+";":e:t?" "+t+'="'+e+'"':" "+e:""},$submit:function(e,t){}},new t(e)},tab:function(e){function t(e){this.config=e,this.theme=this.config.theme||{},this.$load()}var s=this;return t.prototype={type:1,theme_list:[{content:"tab-body",nav:"tab-nav",body:"tab-con",active:"on"},{content:"bt-w-body",nav:"bt-w-menu",body:"bt-w-con"}],random:bt.get_random(5),$init:function(){var e=this,t=(this.config.active,e.config.list);this.$event_bind(),t[e.active].success&&t[e.active].success(),t[e.active].init=!0},$load:function(){},$reader_content:function(){var e=this,t=e.config.list,a="",i="",n=e.theme,c=e.config;return void 0===e.active&&(e.active=0),$.isEmptyObject(c.theme)||(n=this.theme_list[e.active],$.each(c.theme,function(e,t){n[e]&&(n[e]+=" "+t)}),e.theme=n),c.type&&$.isEmptyObject(c.theme)&&(this.theme=this.theme_list[e.active]),$.each(t,function(t,s){var c=e.active===t,l=n.active||"active";a+='<span class="'+(c?l:"")+'">'+s.title+"</span>",i+='<div class="tab-block '+(c?l:"")+'">'+(c?s.content:"")+"</div>"}),e.element=$('<div id="tab_'+e.random+'" class="'+n.content+s.$verify(e.config.class)+'"><div class="'+n.nav+'" >'+a+'</div><div class="'+n.body+'">'+i+"</div></div>"),e.element[0].outerHTML},$reader_find:function(){},$event_bind:function(){var e=this,t=e.theme,s=t.active||"active";e.el||(e.element=$("#tab_"+e.random)),e.element.on("click","."+t.nav.replace(/\s+/g,".")+" span",function(){var a=$(this).index(),i=e.config.list[a];$(this).addClass(s).siblings().removeClass(s),$("."+t.body+">div:eq("+a+")").addClass(s).siblings().removeClass(s),e.active=a,i.init||($("."+t.body+">div:eq("+a+")").html(i.content),i.success&&i.success(),i.init=!0)})}},new t(e)},load:function(e){var t=layer.msg("正在"+e+"，请稍候...",{icon:16,time:0,shade:.3});return!0===e&&(t=layer.load()),{close:function(){layer.close(t)}}},open:function(e){var t={},s=null;return t=$.extend({type:1,area:"640px",closeBtn:2,btn:["确认","取消"]},e),s=layer.open(t),{close:function(){layer.close(s)}}},msg:function(e,t){var s=null,a="",i={};return"object"==typeof e&&"boolean"==typeof e.status&&(a=e.msg,i={icon:e.status?1:2}),"string"==typeof e&&(a=e,i={icon:void 0!==t?t:1}),s=layer.msg(a,i),{close:function(){layer.close(s)}}},$verify:function(e,t,s){return e?!0===s?e?" "+t:"":"style"===s?t?t+":"+e+";":e:t?" "+t+'="'+e+'"':" "+e:""},send:function(e,t,s,a,i,n){function c(e){try{o="function"==d[e][1]?d[e][0]:null,r="function"==d[e+1][1]?d[e+1][0]:null}catch(e){}}var l={},o=null,r=null,d=[],h="";switch($.each(arguments,function(e,t){d.push([t,typeof t])}),h=d[0],h[1]){case"string":$.each(d,function(e,t){var s=t[0],a=t[1];if(e>1&&("boolean"==a||"string"==a||"object"==a)){var i=h[0].split("/")
;return l.url="/"+i[0]+"?action="+i[1],l.load=s,"object"==a&&(l.load=s.load,l.tips=s.tips,l.verify=s.verify),!1}l.url=h[0]}),"object"===d[1][1]?(l.data=d[1][0],c(2)):c(1);break;case"object":l.url=h[0].url,l.data=h[0].data||{},$.each(d,function(e,t){var s=t[0],a=t[1];if(e>1&&("boolean"==a||"string"==a||"object"==a))return l.load=t,"object"==a&&(l.load=s.load,l.tips=s.tips),!0}),"object"===d[1][1]?(l.data=d[1][0],c(2)):c(1)}l.load&&(l.load=this.load(l.load)),$.ajax({type:l.type||"POST",url:l.url,data:l.data||{},dataType:l.dataType||"JSON",complete:function(){l.load&&l.load.close()},success:function(e){return l.verify?(o&&o(e),!1):"string"==typeof e?(layer.msg(e,{icon:2,time:0,closeBtn:2}),!1):l.bacth?(o&&o(e),!1):!1===e.status?(bt_tools.msg(e),!1):(l.tips&&bt_tools.msg(e),void(o&&o(e)))},error:function(e){r&&r(e),layer.closeAll("dialog"),layer.closeAll("loading"),layer.msg("服务响应错误："+e.status+"</br>错误信息："+e.statusText+"</br>接口信息："+l.url+"</br>接口参数："+JSON.stringify(l.data),{icon:2,time:0,closeBtn:2})}})}};$.fn.serializeObject=function(){var e=Object.prototype.hasOwnProperty;return this.serializeArray().reduce(function(t,s){return e.call(t,s.name)||(t[s.name]=s.value),t},{})};